<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .container {
            width: 1200px;
            height: 700px;
        }
        .content {
            width: 1100px;
            height: 100%;
            background-image: url(../images/rollercoaster/171552878-amusement-park-scene-with-roller-coaster-illustration.jpg);
            background-size: cover; /* 빈 공간 없이 꽉 채움. 비율은 유지되지만, div의 비율과 맞지 않는 부분은 잘린다. */
            background-repeat: no-repeat;   /* 반복 삭제. */
            float: left;
            /* position: relative;  원래 이거 붙어야 하는데 지금의 경우 붙이면 오히려 이상해진다. */

        }
        .aside {
            width: 100px;
            height: 100%;
            background-color: azure;
            float: left;
            overflow: scroll;
        }
    </style>

    <script>
        let positionList=new Array(); // 좌표를 누적할 배열 선언.
        // 현재는 1차원 배열이지만 좌표를 넣을 것이기 때문에 추후 2차원 배열이 돼야 한다.
        // 프로그램이 끝날 때 까지 살아있으면서 좌표를 누적시켜야 하므로 전역변수로 선언한다.

        let txt = ``;   // 문자열을 누적할 변수
        let img; // 캐릭터를 다른 함수에서도 접근하기 위해 전역변수로 선언.
        let index = 0;  // 수동 진행시 좌표를 누적시키면서 증가시키기 위해 전역변수 선언.
        let speed;  // 자동 진행시 움직이는 속도 초기화 용도

        // 유저가 일으키는 모든 실시간 이벤트 정보는 자바스크립트의 내장된 객체 중 event 객체가 처리한다.
        function move() {
            let x = event.clientX; // 마우스의 x좌표
            let y = event.clientY; // 마우스의 y좌표
            // 우측의 aside 안에 출력하기
            let position=[x,y]; // 일차원 배열을 생성하여 좌표를 만들고
            // 현재 position은 지역변수이기 때문에 닫는 스코프(})를 만나서 소멸하기 전에 전역변수인 positionList 에 담는다.
            // java.util.List 는 동적 요소 추가시 add() 메서드를 사용하지만, js는 배열에 동적으로 요소를 추가할 수 있는데,
            // 이 때 사용하는 메서드 push()를 적용한다.
            positionList.push(position);  // 이차원 배열에 일차원 배열을 추가.

            txt = txt + `x=${x}, y=${y}\n`;

            // 좌표를 출력하는 문자열이 대체되지 않고, 누적이 되게 처리한다.
            document.querySelector(".aside").innerText=txt;

            // 이 함수를 호출할 때 마다 div 요소를 동적(=runtime 실행 시)으로 생성하여 content div 화면에 부착
            let dot = document.createElement("div");  // 점 하나를 시각화할 div
            // 모든 태그는 기본이 투명이므로 배경색과 크기를 부여해야 한다.
            dot.style.backgroundColor = 'red';
            dot.style.width=4+"px";
            dot.style.height=4+"px";

            // 부모인 content를 기준으로 한 위치 속성인 absolute를 적용한다. 이 경우, content의 꼭지점이 dot의 0,0 좌표가 됨
            dot.style.position="absolute";
            dot.style.left=`${x}px`;
            dot.style.top=`${y}px`;

            // 생성된 dot을 부모인 content에 동적으로 추가한다.
            document.querySelector(".content").appendChild(dot);
        }
        function init() {
            // 동적 프로그래밍으로 생성하려면 createElement() 메서드를 사용해야 한다.
            img = document.createElement("img");   // <img> 태그와 동일한 효과.
            img.src="/images/daggori.webp";
            img.style.width=80+"px";
            
            // HTML 태그 요소는 개발자가 특별히 position을 명시하지 않으면 디폴트가 static이므로,
            // left, top이 적용되지 않아 왼쪽 상단을 기준으로 부착된다.
            // 따라서 위치를 자유롭게 하고 싶다면 개발자는 css의 position을 명시한다.
            // 1) absolute: 부모 요소를 기준으로 한 위치 속성
            // 2) relative: 현재 자신의 본연의 위치를 기준으로 한 위치 속성
            // 현재 캐릭터는 부모인 content div 를 기준으로 위치를 지정할 것이므로, absolute로 지정해야 한다.
            img.style.position="absolute";
            img.style.left=`50px`;
            img.style.top=`100px`;

            // 부모 요소를 content로 두고, 그 안에 자식으로 부착.
            document.querySelector(".content").appendChild(img);
        }
        // 문서 내의 content 영역 안에 존재하는 이미지의 위치를 누적된 좌표를 대상으로 순서대로 접근해보자.
        function manual() {
            // 이차원 배열인 position에 누적되어 있는 일차원 배열의 좌표 정보를 이용하여.
            // 캐릭터의 left, top 값을 지정한다.
            // 버튼을 누를 때 마다 positionList의 좌표값을 1씩 증가시키며 진행하면 된다.
            img.style.left=positionList[index][0]-50+"px";  // X좌표를 의미
            img.style.top=positionList[index][1]-50+"px";  // Y좌표를 의미

            img.style.transform = `rotate(${index * 45}deg)`; // 이건 재미로 추가해 본 회전하면서 돌기. 각도를 부여한다.

            index ++
        }
        function auto() {
            if (speed) {  // 속도 초기화
                clearInterval(speed);
            }
            index=0;  // 좌표 초기화
            speed = setInterval(manual,80);
        }
    </script>
</head>
<body onload="init()">
    <div class="container">
        <div class="content" onmousedown="move()">
        </div>
        
        <div class="aside">
        </div>
        <button onclick="manual()">수동</button>
        <button onclick="auto()">자동</button>
    </div>
</body>
</html>